<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- css -->
  <link rel="stylesheet" href="js/element-2.4.11/theme-chalk/index.css">
  <link rel="stylesheet" href="css/fontawesome5.6.3/css/all.css">
  <link rel="stylesheet" href="css/index.css">
  <style type="text/css">
  .time {
    font-size: 13px;
    color: #999;
  }
  
  .bottom {
    margin-top: 13px;
    line-height: 12px;
  }

  .button {
    padding: 0;
    float: right;
  }

  .image {
    width: 100%;
    display: block;
  }

  .clearfix:before,
  .clearfix:after {
      display: table;
      content: "";
  }
  
  .clearfix:after {
      clear: both
  }
  </style>
</head>
<body class="animated fadeIn">
  <div id="app">
  
  	<div v-show="!preloading" class="el-loading-mask" style="background-color: rgba(255,255,255,1);">
	   <div class="el-loading-spinner">
	    <i class="fa fa-spinner fa-pulse"></i>
 	    <p class="el-loading-text">Loading...</p>
	   </div>
    </div>
    
    <section style="padding: 20px;" v-show="preloading">
		<!-- filter -->
		<el-row>
		<el-col :span="24" class="toolbar" style="padding-bottom: 0px;">
			<el-col :span="24">
			<el-tabs value="filter" >
			    <el-tab-pane label="筛选" name="filter" disabled>
			    <el-form :inline="true" :model="filters" style="float: right;">
					<el-form-item>
						  <el-input v-model="filters.sn" placeholder="请输入序列号" clearable></el-input>
					</el-form-item>
					<el-form-item>
					    <el-select v-model="filters.alarm" placeholder="报警状态">
						    <el-option
						      v-for="item in alarmOptions"
						      :key="item.value"
						      :label="item.label"
						      :value="item.value">
						    </el-option>
					    </el-select>
					</el-form-item>
					<el-form-item>
					    <el-select v-model="filters.connected" placeholder="连接状态">
						    <el-option
						      v-for="item in connectedOptions"
						      :key="item.value"
						      :label="item.label"
						      :value="item.value">
						    </el-option>
					    </el-select>
					</el-form-item>
					<el-form-item>
					    <el-select v-model="filters.status" placeholder="航标状态">
						    <el-option
						      v-for="item in statusOptions"
						      :key="item.value"
						      :label="item.label"
						      :value="item.value">
						    </el-option>
					    </el-select>
					</el-form-item>
					<el-form-item>
						<el-button type="primary" @click="query" icon="fa fa-search">&nbsp;&nbsp;查询</el-button>
						<el-button @click="reset" icon="fa fa-recycle">&nbsp;&nbsp;重置</el-button>
						&nbsp;&nbsp;&nbsp;&nbsp;
						<el-button type="primary" @click="handleAdd">新增</el-button>
					</el-form-item>
				</el-form>
			    </el-tab-pane>
		    </el-tabs>
				
			</el-col>
		</el-col>
		</el-row>
		
	    <el-tabs v-model="activeTab" >
		    <el-tab-pane label="结果" name="table" disabled>
				<!-- list -->
				<el-table :data="list" highlight-current-row border v-loading="listLoading" @selection-change="selsChange" style="width: 100%;" class="mytable" >
					<el-table-column label="Pid" prop="pid" width="120">
					</el-table-column>
					<el-table-column label="序列号" prop="sn" >
					</el-table-column>
					<el-table-column label="名称" prop="name" >
					</el-table-column>
					<el-table-column label="创建时间" prop="createtime" >
					</el-table-column>
					<el-table-column label="曾连接过" prop="connected" >
					</el-table-column>
					<el-table-column label="状态" prop="status" >
					</el-table-column>
					<el-table-column label="报警状态" prop="alarm">
					</el-table-column>
					<!-- <el-table-column label="重连次数" prop="resend" >
					</el-table-column> -->
					<el-table-column fixed="right" label="操作" width="100">
						<!-- <template scope="scope">
							<el-button size="small" @click="handleEdit(scope.$index, scope.row)">编辑</el-button>
							<el-button type="primary" size="small" @click="handlePic(scope.$index, scope.row)">图片</el-button>
							<el-button type="danger" size="small" @click="handleDel(scope.$index, scope.row)">删除</el-button>
						</template> -->
						<template scope="scope">
							<el-dropdown size="small">
							  <el-button type="primary" size="small">
							   	<i class="fas fa-cog"></i>
							  </el-button>
							  <el-dropdown-menu slot="dropdown">
							    <el-dropdown-item @click.native="handleEdit(scope.$index, scope.row)" >
							    	<i class="fas fa-edit"></i>&nbsp;编辑
							    </el-dropdown-item>
							    <el-dropdown-item @click.native="handlePicDir(scope.$index, scope.row)" >
							    	<i class="fas fa-image"></i>&nbsp;查看图片
							    </el-dropdown-item>
							    <el-dropdown-item @click.native="handleRefreshPic(scope.$index, scope.row)" divided >
							    	<i class="fas fa-sync"></i>&nbsp;更新图片
							    </el-dropdown-item>
							    <el-dropdown-item @click.native="handleRefreshData(scope.$index, scope.row)" >
							    	<i class="fas fa-sync"></i>&nbsp;更新数据
							    </el-dropdown-item>
							    <el-dropdown-item @click.native="handleSet(scope.$index, scope.row)" >
							    	<i class="fas fa-cog"></i>&nbsp;设置配置
							    </el-dropdown-item>
							    <el-dropdown-item @click.native="handleDel(scope.$index, scope.row)" divided style="color: #f56c6c;" >
							    	<i class="fas fa-trash-alt"></i>&nbsp;删除
							    </el-dropdown-item>
							  </el-dropdown-menu>
							</el-dropdown>
						</template>
					</el-table-column>
				</el-table>
		
				<!-- page tool -->
				<el-col :span="24" class="toolbar">
					<!-- <el-button type="danger" @click="batchRemove" :disabled="this.sels.length===0">Batch remove</el-button> -->
					<el-pagination layout="total, sizes, prev, pager, next, jumper" @size-change="handleSizeChange" @current-change="handleCurrentChange" 
						:page-sizes="[10, 20, 50, 100]" :page-size="rows" :total="total" :current-page="page" style="float:right;">
					</el-pagination>
				</el-col>
			</el-tab-pane>
		  </el-tabs>
		
		
		<!-- add -->
		<el-dialog title="新增" :visible.sync="addFormVisible" :close-on-click-modal="false">
			<el-form :model="addForm"  :rules="addFormRules" ref="addForm">
				<el-form-item label="名称" prop="name">
					<el-input type="text" v-model="addForm.name"></el-input>
				</el-form-item>
				<el-form-item label="序列号" prop="sn">
					<el-input type="text" v-model="addForm.sn"></el-input>
				</el-form-item>
			</el-form>
			<div slot="footer" class="dialog-footer">
				<el-button @click="addClose">取消</el-button>
				<el-button type="primary" @click="addSubmit" :loading="addLoading">提交</el-button>
			</div>
		</el-dialog>
		
		<!-- edit -->
		<el-dialog title="编辑" :visible.sync="editFormVisible" :close-on-click-modal="false">
			<el-form :model="editForm" :rules="editFormRules" ref="editForm">
				<el-form-item label="名称" prop="name">
					<el-input type="text" v-model="editForm.name"></el-input>
				</el-form-item>
				<el-form-item label="序列号" prop="sn">
					<el-input type="text" v-model="editForm.sn" disabled></el-input>
				</el-form-item>
			</el-form>
			<div slot="footer" class="dialog-footer">
				<el-button @click="editClose">取消</el-button>
				<el-button type="primary" @click="editSubmit" :loading="editLoading">提交</el-button>
			</div>
		</el-dialog>
		
		
		<!-- pic dir -->
		<el-dialog :title="picDirTitle" :visible.sync="picDirFormVisible" :close-on-click-modal="false" width="50%">
			<el-row>
			  <el-col :span="9" v-for="(item, index) in picDirLists" :key="index" :offset="2">
			    <el-card @click.native="handlePic(item.sn, item.dir)" :body-style="{ padding: '0px', cursor: 'pointer' }" style="margin-bottom:10px;">
			      <img src="/admin/images/dir.png" class="image">
			      <div style="padding: 14px;text-align: center;">
			        <span>{{ item.name }}</span>
			      </div>
			    </el-card>
			  </el-col>
			</el-row>
			<div slot="footer" class="dialog-footer">
				<el-button @click="picDirClose">关闭</el-button>
			</div>
		</el-dialog>
		
		<!-- pic -->
		<el-dialog :title="picTitle" :visible.sync="picFormVisible" :close-on-click-modal="false" width="90%">
			
			<el-row>
				<el-col :span="24" class="toolbar">
					<el-pagination layout="total, sizes, prev, pager, next, jumper" @size-change="handleSizeChangePic" @current-change="handleCurrentChangePic" 
						:page-sizes="[10, 20, 50, 100]" :page-size="picRows" :total="picTotal" :current-page="picPage" style="text-align: center; margin: 0 0 5px 0;">
					</el-pagination>
				</el-col>
			</el-row>
			
			<el-row>
			  <el-col :span="9" v-for="(item, index) in picLists" :key="index" :offset="2">
			    <el-card :body-style="{ padding: '0px' }" style="margin-bottom:10px;">
			      <img :src="item.uri" class="image">
			      <div style="padding: 14px;">
			        <span>{{ item.name }}</span>
			        <div class="bottom clearfix">
			          <time class="time">{{ item.date }}</time>
			        </div>
			      </div>
			    </el-card>
			  </el-col>
			</el-row>
			
			<el-row>
				<el-col :span="24" class="toolbar">
					<el-pagination layout="total, sizes, prev, pager, next, jumper" @size-change="handleSizeChangePic" @current-change="handleCurrentChangePic" 
						:page-sizes="[10, 20, 50, 100]" :page-size="picRows" :total="picTotal" :current-page="picPage"  style="text-align: center; margin: 5px 0 0 0;">
					</el-pagination>
				</el-col>
			</el-row>
			
			<div slot="footer" class="dialog-footer">
				<el-button @click="picClose">关闭</el-button>
			</div>
		</el-dialog>
		
		
		<!-- setting -->
		<el-dialog title="设置" :visible.sync="setFormVisible" :close-on-click-modal="false">
			<el-form :model="setForm"  :rules="setFormRules" ref="setForm" label-width="80px">
				<el-form-item label="序列号" prop="sn">
					<el-input type="text" v-model="setForm.sn" disabled></el-input>
				</el-form-item>
				<el-form-item label="S1" prop="s1">
					<el-input type="text" v-model="setForm.s1"></el-input>
				</el-form-item>
				<el-form-item label="S2" prop="s2">
					<el-input type="text" v-model="setForm.s2"></el-input>
				</el-form-item>
				<el-form-item label="S3" prop="s3">
					<el-input type="text" v-model="setForm.s3"></el-input>
				</el-form-item>
				<el-form-item label="S4" prop="s4">
					<el-input type="text" v-model="setForm.s4"></el-input>
				</el-form-item>
				<el-form-item label="AX" prop="ax">
					<el-input type="text" v-model="setForm.ax"></el-input>
				</el-form-item>
				<el-form-item label="AY" prop="ay">
					<el-input type="text" v-model="setForm.ay"></el-input>
				</el-form-item>
			</el-form>
			<div slot="footer" class="dialog-footer">
				<el-button @click="setClose">取消</el-button>
				<el-button type="primary" @click="setSubmit" :loading="setLoading">提交</el-button>
			</div>
		</el-dialog>
		
	</section>
  </div>
</body>
  <script src="js/jquery-3.4.1.js" type="text/javascript"></script>
  <script src="js/vue-2.6.10/vue.js" type="text/javascript"></script>
  <script src="js/element-2.4.11/index.js" type="text/javascript"></script>
  <script type="text/javascript" src="js/global.js"></script>
  <script type="text/javascript" src="js/beacon.js"></script>
</html>